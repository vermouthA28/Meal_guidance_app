<h1>投稿一覧</h1>

<!--絞り込み機能-->
  <%= form_with url: {controller: :posts, action: :index}, method: :get do |f| %>
  <div class="form-row align-items-end">
    <div class="col-4">
       <%= f.label :genre_id, "ジャンル" %>
       <%= f.select :genre_id, options_for_select(Post.genre_ids.map { |key, value| [I18n.t("enums.post.genre_id.#{key}"), value] }), { prompt: "" }, class: "form-control" %>
    </div>
    <div class="col">
      <%= f.label :start_date, "開始日" %>
      <%= f.date_field :start_date, class: "form-control" %>
    </div>
    <div class="col">
      <%= f.label :end_date, "終了日" %>
      <%= f.date_field :end_date, class: "form-control" %>
    </div>
    <div class="col">
      <%= f.submit "絞り込み", class: "btn btn-primary" %>
    </div>
  </div>
<% end %>

<!--投稿一覧-->
<div class="container d-flex flex-column align-items-center justify-content-center" style="height: 80vh;">
  <div class="d-flex flex-wrap justify-content-around">
    <% @posts.each do |post| %>
      <div class="flex-item mb-4 mx-4">
        <div class="card" style="margin: 20;">
          <% if post.image.present? %>
            <%= image_tag post.image, size: "150x150", class: "card-img-top" %>
          <% else %>
            <%= image_tag 'no-image', size: "150x150", class: "card-img-top" %>
          <% end %>
          <div class="card-body"  style="line-height: normal;">
            <h5 class="card-title">日時</h5>
            <%= link_to post_path(post) do %>
              <span class="date-time-block"><%= post.eaten_at.strftime("%Y年 %m月 %d日 %H:%M") %></span>
            <% end %>

            <%= form_with model:post do |f| %>
              <h6 class="genre-block">ジャンル： <%= I18n.t("enums.post.genre_id.#{post.genre_id}") %></h6>
            <% end %>

            <h5 class="card-title">食事内容</h5>
            <span>
              <%= content_tag(:ul) do %>
                <% post.meal_content.split("\n").each do |content| %>
                  <%= content_tag(:li, content) %>
                <% end %>
              <% end %>
            </span><br>


            <p>コメント数： <%= post.comments.count %></p>

            <% if post.post_todos.present? %>
              <p>Todo達成：<%= post.post_todos.count %></p>
            <% else %>
              <p>Todo達成：0</p>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
      <div class="text-center">
        <%= paginate @posts, theme: 'bootstrap-5' %>
      </div>
  </div>
</div>





